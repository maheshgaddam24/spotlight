<!-- your-component.component.html -->
<div class="container-fluid p-0">
    <div class="container-header d-flex flex-column">
        <div class="breadcrumb px-4 m-0 d-flex">
            <div>
                <a [href]="routeHome()">
                    <img class="home-icon" src="../../assets/images/home.svg" alt="home">
                </a>
            </div>
            <div class="project-name" *ngIf="!showDropdown" (click)="showDropdown = true">
                {{ selectedProject| titlecase }}
            </div>
            <select class="project-name-dropdown" *ngIf="showDropdown" [(ngModel)]="selectedProject"
                (blur)="showDropdown = false" (change)="onSelectChange($event)">
                <option *ngFor="let project of projects" [value]="project.project_name">
                    {{ project.project_name | titlecase }}
                </option>
            </select>
        </div>
        <div class="tabs d-flex px-4">
            <nav mat-tab-nav-bar [tabPanel]="tabPanel">
                <a class="tab d-flex align-items-center justify-content-center" *ngFor="let link of links"
                    (click)="activeLink = link.name; switchTab()" [ngClass]="{'active': activeLink == link.name}">
                    <img class="tab-icon" [src]="link.icon"
                        [ngStyle]="{'filter': (activeLink == link.name) ? 'invert(1)' : 'none'}" alt="icon">
                    <span class="tab-text">{{link.name}}</span>
                </a>
            </nav>
        </div>
    </div>

    <div class="container-body">
        <mat-tab-nav-panel #tabPanel class="flow">
            <div class="flow-chart" *ngIf="activeLink === 'Define Pipelines'"
                [ngStyle]="{'transform': 'scale(' + zoomLevel + ')'}">
                <!-- <div *ngIf="loading" class="dataSoucresLoading ">
                    <div id="loading-bar-spinner" class="spinner">
                        <div class="spinner-icon"></div>
                    </div>
                </div> -->
                <div class="cards-container" cdkDrag id="cards-container">
                    <div class="cards-column d-flex flex-column gap-2" *ngFor="let card of cards; let last = last">
                        <div class="d-flex">
                            <div class="card d-flex"
                                [class.active]="card.title === 'Refined Workflows' || card.title === 'Report Workflows'">
                                <div class="card-head d-flex">
                                    <div class="card-icon"><img class="image" src={{card.icon}} alt=""></div>
                                    <div class="card-title">{{card.title}}</div>
                                </div>
                                <div class="card-body p-0 d-flex flex-column">
                                    <div class="card-desc">
                                        {{card.description}}
                                    </div>
                                    <div class="buttons d-flex">
                                        <button class="config-button"
                                            (click)="routeHref(card.title)">{{card.route}}</button>
                                    </div>
                                </div>
                            </div>
                            <img class="arrow" *ngIf="!last" src="../../assets/images/arrow-icon.png" alt="">
                        </div>
                        <img class="arrow-down" *ngIf="card.scheduler" src="../../assets/images/arrow-down.png" alt="">
                        <div class="card" *ngIf="card.scheduler">
                            <div class="card-head d-flex">
                                <div class="card-icon"><img class="image" src={{card.scheduler.icon}} alt=""> </div>
                                <div class="card-title">{{card.scheduler.title}}</div>
                            </div>
                            <div class="card-body p-0 d-flex flex-column">
                                <div class="card-desc">
                                    {{card.scheduler.description}}
                                </div>
                                <div class="buttons d-flex justify-content-between">
                                    <div> <button class="config-button"
                                            (click)="routeHref(card.scheduler.title)">{{card.scheduler.route}}</button>
                                    </div>
                                    <div class="logs">
                                        <div class="logs-failed" *ngIf="card.scheduler.success_count >0"
                                            [matTooltip]="card.scheduler.success_count >9 ? 'Success jobs ' +  '(' +card.scheduler.success_count+ ')'  : 'Success jobs' "
                                            data-bs-toggle="offcanvas" data-bs-target="#auditOffcanvasRight"
                                            aria-controls="offcanvasRight"
                                            (click)="auditLogs(card.scheduler.title,'success_count')">
                                            <svg class="vector" width="19" height="20" viewBox="0 0 19 20" fill="none"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path
                                                    d="M9 17.9971H3C2.73478 17.9971 2.48043 17.8917 2.29289 17.7042C2.10536 17.5166 2 17.2623 2 16.9971V2.99707C2 2.73185 2.10536 2.4775 2.29289 2.28996C2.48043 2.10243 2.73478 1.99707 3 1.99707H8V4.99707C8 5.79272 8.31607 6.55578 8.87868 7.11839C9.44129 7.681 10.2044 7.99707 11 7.99707H14V12.9971C14 13.2623 14.1054 13.5166 14.2929 13.7042C14.4804 13.8917 14.7348 13.9971 15 13.9971C15.2652 13.9971 15.5196 13.8917 15.7071 13.7042C15.8946 13.5166 16 13.2623 16 12.9971V6.99707C16 6.99707 16 6.99707 16 6.93707C15.9896 6.8452 15.9695 6.7547 15.94 6.66707V6.57707C15.8919 6.47425 15.8278 6.37974 15.75 6.29707L9.75 0.29707C9.66734 0.219286 9.57282 0.155151 9.47 0.10707C9.43692 0.10128 9.40308 0.10128 9.37 0.10707C9.27276 0.0550734 9.16826 0.0179923 9.06 -0.00292969H3C2.20435 -0.00292969 1.44129 0.313141 0.87868 0.87575C0.316071 1.43836 0 2.20142 0 2.99707V16.9971C0 17.7927 0.316071 18.5558 0.87868 19.1184C1.44129 19.681 2.20435 19.9971 3 19.9971H9C9.26522 19.9971 9.51957 19.8917 9.70711 19.7042C9.89464 19.5166 10 19.2623 10 18.9971C10 18.7319 9.89464 18.4775 9.70711 18.29C9.51957 18.1024 9.26522 17.9971 9 17.9971ZM10 3.40707L12.59 5.99707H11C10.7348 5.99707 10.4804 5.89171 10.2929 5.70418C10.1054 5.51664 10 5.26229 10 4.99707V3.40707ZM5 11.9971H11C11.2652 11.9971 11.5196 11.8917 11.7071 11.7042C11.8946 11.5166 12 11.2623 12 10.9971C12 10.7319 11.8946 10.4775 11.7071 10.29C11.5196 10.1024 11.2652 9.99707 11 9.99707H5C4.73478 9.99707 4.48043 10.1024 4.29289 10.29C4.10536 10.4775 4 10.7319 4 10.9971C4 11.2623 4.10536 11.5166 4.29289 11.7042C4.48043 11.8917 4.73478 11.9971 5 11.9971ZM9 13.9971H5C4.73478 13.9971 4.48043 14.1024 4.29289 14.29C4.10536 14.4775 4 14.7319 4 14.9971C4 15.2623 4.10536 15.5166 4.29289 15.7042C4.48043 15.8917 4.73478 15.9971 5 15.9971H9C9.26522 15.9971 9.51957 15.8917 9.70711 15.7042C9.89464 15.5166 10 15.2623 10 14.9971C10 14.7319 9.89464 14.4775 9.70711 14.29C9.51957 14.1024 9.26522 13.9971 9 13.9971ZM5 7.99707H6C6.26522 7.99707 6.51957 7.89171 6.70711 7.70418C6.89464 7.51664 7 7.26229 7 6.99707C7 6.73185 6.89464 6.4775 6.70711 6.28996C6.51957 6.10243 6.26522 5.99707 6 5.99707H5C4.73478 5.99707 4.48043 6.10243 4.29289 6.28996C4.10536 6.4775 4 6.73185 4 6.99707C4 7.26229 4.10536 7.51664 4.29289 7.70418C4.48043 7.89171 4.73478 7.99707 5 7.99707ZM18.71 14.2871C18.617 14.1933 18.5064 14.1189 18.3846 14.0682C18.2627 14.0174 18.132 13.9913 18 13.9913C17.868 13.9913 17.7373 14.0174 17.6154 14.0682C17.4936 14.1189 17.383 14.1933 17.29 14.2871L14 17.5871L12.71 16.2871C12.6168 16.1938 12.5061 16.1199 12.3842 16.0694C12.2624 16.0189 12.1319 15.993 12 15.993C11.8681 15.993 11.7376 16.0189 11.6158 16.0694C11.4939 16.1199 11.3832 16.1938 11.29 16.2871C11.1968 16.3803 11.1228 16.491 11.0723 16.6128C11.0219 16.7346 10.9959 16.8652 10.9959 16.9971C10.9959 17.1289 11.0219 17.2595 11.0723 17.3813C11.1228 17.5031 11.1968 17.6138 11.29 17.7071L13.29 19.7071C13.383 19.8008 13.4936 19.8752 13.6154 19.926C13.7373 19.9767 13.868 20.0029 14 20.0029C14.132 20.0029 14.2627 19.9767 14.3846 19.926C14.5064 19.8752 14.617 19.8008 14.71 19.7071L18.71 15.7071C18.8037 15.6141 18.8781 15.5035 18.9289 15.3816C18.9797 15.2598 19.0058 15.1291 19.0058 14.9971C19.0058 14.8651 18.9797 14.7344 18.9289 14.6125C18.8781 14.4906 18.8037 14.38 18.71 14.2871Z"
                                                    fill="#00406B" />
                                            </svg>
                                            <svg class="vector2" width="8" height="6" viewBox="0 0 8 6" fill="none"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path
                                                    d="M7.70994 0.28701C7.61698 0.193282 7.50638 0.118886 7.38452 0.0681171C7.26266 0.0173485 7.13195 -0.00878906 6.99994 -0.00878906C6.86793 -0.00878906 6.73722 0.0173485 6.61536 0.0681171C6.49351 0.118886 6.38291 0.193282 6.28994 0.28701L2.99994 3.58701L1.70994 2.28701C1.6167 2.19377 1.50601 2.11981 1.38419 2.06935C1.26237 2.01889 1.1318 1.99292 0.999941 1.99292C0.868082 1.99292 0.737513 2.01889 0.615691 2.06935C0.493869 2.11981 0.383179 2.19377 0.289941 2.28701C0.196702 2.38025 0.122741 2.49094 0.0722809 2.61276C0.0218206 2.73458 -0.00415039 2.86515 -0.00415039 2.99701C-0.00415039 3.12887 0.0218206 3.25943 0.0722809 3.38126C0.122741 3.50308 0.196702 3.61377 0.289941 3.70701L2.28994 5.70701C2.3829 5.80074 2.4935 5.87513 2.61536 5.9259C2.73722 5.97667 2.86793 6.00281 2.99994 6.00281C3.13195 6.00281 3.26266 5.97667 3.38452 5.9259C3.50638 5.87513 3.61698 5.80074 3.70994 5.70701L7.70994 1.70701C7.80367 1.61405 7.87806 1.50345 7.92883 1.38159C7.9796 1.25973 8.00574 1.12902 8.00574 0.997009C8.00574 0.864997 7.9796 0.734292 7.92883 0.612432C7.87806 0.490573 7.80367 0.379973 7.70994 0.28701Z"
                                                    fill="#039855" />
                                            </svg>
                                            <div class="frame-52"
                                                [ngClass]="{ 'count_added': card.scheduler.success_count > 9 }">
                                                <div class="_2">{{ card.scheduler.success_count
                                                    > 9 ? '9+' : card.scheduler.success_count }}</div>
                                            </div>
                                        </div>
                                        <div class="logs-failed" *ngIf="card.scheduler.failed_count >0"
                                            [matTooltip]="card.scheduler.failed_count >9 ? 'Failed jobs ' + '('+ card.scheduler.failed_count  + ')'  : 'Failed jobs' "
                                            data-bs-toggle="offcanvas" data-bs-target="#auditOffcanvasRight"
                                            aria-controls="offcanvasRight"
                                            (click)="auditLogs(card.scheduler.title,'failed_count')">
                                            <svg class="vector3" width="16" height="20" viewBox="0 0 16 20" fill="none"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path
                                                    d="M5 7.99414H6C6.26522 7.99414 6.51957 7.88878 6.70711 7.70125C6.89464 7.51371 7 7.25936 7 6.99414C7 6.72892 6.89464 6.47457 6.70711 6.28703C6.51957 6.0995 6.26522 5.99414 6 5.99414H5C4.73478 5.99414 4.48043 6.0995 4.29289 6.28703C4.10536 6.47457 4 6.72892 4 6.99414C4 7.25936 4.10536 7.51371 4.29289 7.70125C4.48043 7.88878 4.73478 7.99414 5 7.99414ZM11 9.99414H5C4.73478 9.99414 4.48043 10.0995 4.29289 10.287C4.10536 10.4746 4 10.7289 4 10.9941C4 11.2594 4.10536 11.5137 4.29289 11.7012C4.48043 11.8888 4.73478 11.9941 5 11.9941H11C11.2652 11.9941 11.5196 11.8888 11.7071 11.7012C11.8946 11.5137 12 11.2594 12 10.9941C12 10.7289 11.8946 10.4746 11.7071 10.287C11.5196 10.0995 11.2652 9.99414 11 9.99414ZM11 13.9941H5C4.73478 13.9941 4.48043 14.0995 4.29289 14.287C4.10536 14.4746 4 14.7289 4 14.9941C4 15.2594 4.10536 15.5137 4.29289 15.7012C4.48043 15.8888 4.73478 15.9941 5 15.9941H11C11.2652 15.9941 11.5196 15.8888 11.7071 15.7012C11.8946 15.5137 12 15.2594 12 14.9941C12 14.7289 11.8946 14.4746 11.7071 14.287C11.5196 14.0995 11.2652 13.9941 11 13.9941ZM15.71 18.2841C15.6625 18.2411 15.6124 18.2011 15.56 18.1641C15.5043 18.1263 15.4437 18.096 15.38 18.0741L15.2 17.9941C15.005 17.9561 14.8031 17.977 14.62 18.0541C14.4959 18.0991 14.3832 18.1707 14.2899 18.264C14.1966 18.3573 14.1249 18.47 14.08 18.5941C14.0209 18.7189 13.9934 18.8563 14 18.9941C13.9983 19.1429 14.0297 19.2902 14.0921 19.4252C14.1545 19.5603 14.2462 19.6797 14.3606 19.7749C14.475 19.87 14.6092 19.9384 14.7534 19.975C14.8976 20.0117 15.0481 20.0158 15.1941 19.9869C15.34 19.958 15.4777 19.8969 15.597 19.8081C15.7164 19.7192 15.8144 19.6049 15.8839 19.4734C15.9535 19.3419 15.9928 19.1965 15.9991 19.0478C16.0053 18.8992 15.9783 18.751 15.92 18.6141C15.8694 18.493 15.7983 18.3813 15.71 18.2841ZM16 6.93414C15.9896 6.84228 15.9695 6.75177 15.94 6.66414V6.57414C15.8919 6.47132 15.8278 6.37681 15.75 6.29414L9.75 0.294141C9.66734 0.216357 9.57282 0.152222 9.47 0.104141C9.44015 0.0999007 9.40985 0.0999007 9.38 0.104141C9.27841 0.0458819 9.16622 0.00848483 9.05 -0.00585938H3C2.20435 -0.00585937 1.44129 0.310211 0.87868 0.87282C0.316071 1.43543 0 2.19849 0 2.99414V16.9941C0 17.7898 0.316071 18.5529 0.87868 19.1155C1.44129 19.6781 2.20435 19.9941 3 19.9941H11C11.2652 19.9941 11.5196 19.8888 11.7071 19.7012C11.8946 19.5137 12 19.2594 12 18.9941C12 18.7289 11.8946 18.4746 11.7071 18.287C11.5196 18.0995 11.2652 17.9941 11 17.9941H3C2.73478 17.9941 2.48043 17.8888 2.29289 17.7012C2.10536 17.5137 2 17.2594 2 16.9941V2.99414C2 2.72892 2.10536 2.47457 2.29289 2.28703C2.48043 2.0995 2.73478 1.99414 3 1.99414H8V4.99414C8 5.78979 8.31607 6.55285 8.87868 7.11546C9.44129 7.67807 10.2044 7.99414 11 7.99414H14V9.99414C14 10.2594 14.1054 10.5137 14.2929 10.7012C14.4804 10.8888 14.7348 10.9941 15 10.9941C15.2652 10.9941 15.5196 10.8888 15.7071 10.7012C15.8946 10.5137 16 10.2594 16 9.99414V6.99414C16 6.99414 16 6.99414 16 6.93414ZM11 5.99414C10.7348 5.99414 10.4804 5.88878 10.2929 5.70125C10.1054 5.51371 10 5.25936 10 4.99414V3.40414L12.59 5.99414H11ZM15 12.9941C14.7348 12.9941 14.4804 13.0995 14.2929 13.287C14.1054 13.4746 14 13.7289 14 13.9941V15.9941C14 16.2594 14.1054 16.5137 14.2929 16.7012C14.4804 16.8888 14.7348 16.9941 15 16.9941C15.2652 16.9941 15.5196 16.8888 15.7071 16.7012C15.8946 16.5137 16 16.2594 16 15.9941V13.9941C16 13.7289 15.8946 13.4746 15.7071 13.287C15.5196 13.0995 15.2652 12.9941 15 12.9941Z"
                                                    fill="#00406B" />
                                            </svg>
                                            <svg class="vector4" width="2" height="7" viewBox="0 0 2 7" fill="none"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path
                                                    d="M1.70998 5.28414C1.66246 5.24114 1.61237 5.20106 1.55999 5.16414C1.50424 5.1263 1.44371 5.09603 1.37998 5.07414L1.19999 4.99414C1.00499 4.95608 0.803067 4.97697 0.619987 5.05414C0.495891 5.09905 0.383189 5.17071 0.28987 5.26403C0.196551 5.35735 0.124898 5.47005 0.0799856 5.59414C0.0208575 5.71888 -0.00661925 5.85626 -1.43292e-05 5.99414C-0.00176334 6.14291 0.0297027 6.29019 0.0920915 6.42525C0.15448 6.56031 0.246219 6.67975 0.360621 6.77486C0.475024 6.86997 0.609207 6.93836 0.75339 6.97503C0.897573 7.01171 1.04812 7.01575 1.19407 6.98687C1.34001 6.95798 1.47767 6.8969 1.59701 6.80807C1.71636 6.71923 1.81437 6.60489 1.88392 6.47337C1.95347 6.34186 1.9928 6.19648 1.99904 6.04783C2.00528 5.89919 1.97827 5.75103 1.91999 5.61414C1.86934 5.49296 1.79832 5.38134 1.70998 5.28414ZM0.999986 -0.00585938C0.734769 -0.00585938 0.480415 0.0994977 0.292878 0.287034C0.105342 0.47457 -1.43292e-05 0.728924 -1.43292e-05 0.994141V2.99414C-1.43292e-05 3.25936 0.105342 3.51371 0.292878 3.70125C0.480415 3.88879 0.734769 3.99414 0.999986 3.99414C1.2652 3.99414 1.51956 3.88879 1.70709 3.70125C1.89463 3.51371 1.99999 3.25936 1.99999 2.99414V0.994141C1.99999 0.728924 1.89463 0.47457 1.70709 0.287034C1.51956 0.0994977 1.2652 -0.00585938 0.999986 -0.00585938Z"
                                                    fill="#D92D20" />
                                            </svg>
                                            <div class="frame-53"
                                                [ngClass]="{ 'count_added': card.scheduler.failed_count > 9 }">
                                                <div class="_3">{{ card.scheduler.failed_count
                                                    > 9 ? '9+' : card.scheduler.failed_count }}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="activeLink === 'Execution Statistics'">
                <app-data-lineage *ngIf="showDataLineage"></app-data-lineage>
            </div>

        </mat-tab-nav-panel>

        <div class="zoom d-flex" *ngIf="activeLink === 'Define Pipelines'">
            <button mat-mini-fab class="zoomBtn" (click)="zoomIn()" aria-label="Zoom In">
                <mat-icon>add</mat-icon>
            </button>
            <button mat-mini-fab class="zoomBtn" (click)="zoomOut()" aria-label="Zoom Out">
                <mat-icon>remove</mat-icon>
            </button>
            <button mat-mini-fab class="zoomBtn" (click)="resetZoom()" aria-label="Reset Zoom">
                <mat-icon>restart_alt</mat-icon>
            </button>
        </div>
    </div>


    <div class="offcanvas offcanvas-end" data-bs-backdrop="static" tabindex="-1" id="auditOffcanvasRight"
        aria-labelledby="offcanvasRightLabel">
        <div>
            <app-audit-logs *ngIf="triggerAuditLogs" [view]="'partial'" [layer_name]="jobLayerName" [status]="jobStatus"
                [exportEnable]="false" [projectId]="projectId"></app-audit-logs>
        </div>

    </div>
</div>